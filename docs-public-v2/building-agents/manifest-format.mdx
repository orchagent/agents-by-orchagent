---
title: "Manifest Format"
description: "The orchagent.json configuration schema"
---

Every agent needs an `orchagent.json` file that defines its configuration, dependencies, and runtime limits.

<Note>
**Skills use a different format.** Skills use a `SKILL.md` file with YAML frontmatter instead of `orchagent.json`. See [Agents & Skills](/building-agents/agent-types#skills) for the SKILL.md format.
</Note>

## Basic Structure

```json
{
  "name": "my-agent",
  "type": "agent",
  "description": "What my agent does",
  "supported_providers": ["openai", "anthropic"],
  "default_endpoint": "analyze",
  "timeout_seconds": 60
}
```

<Note>
**Versions are auto-assigned.** You don't need to specify a `version` field in your manifest. The server automatically assigns versions on each publish (v1, v2, v3...).
</Note>

## Required Fields

| Field | Type | Description |
|-------|------|-------------|
| `name` | string | Agent name (lowercase, hyphens allowed) |
| `type` | string | `"agent"` (default) or `"skill"` |
| `description` | string | Short description of what the agent does |
| `supported_providers` | array | LLM providers: `["openai", "anthropic", "gemini", "any"]`. Managed loop agents must use `["anthropic"]`. |

## Behavior Fields

These fields control **how** and **when** the agent runs. The platform infers the execution engine automatically from what you declare.

| Field | Type | Default | Description |
|-------|------|---------|-------------|
| `run_mode` | string | `"on_demand"` | `"on_demand"` or `"always_on"`. Always-on agents can be deployed as [services](/using-agents/services). |
| `runtime` | object | — | Declares code execution. Sets `execution_engine` to `code_runtime`. |
| `loop` | object | — | Declares managed LLM loop. Sets `execution_engine` to `managed_loop`. |
| `callable` | boolean | `false` | When `true`, other agents can call this agent as a dependency. |

<Warning>
`runtime` and `loop` are mutually exclusive — you cannot declare both. If neither is declared, the platform infers `direct_llm` (single LLM call with your prompt).
</Warning>

### runtime

Declares that the agent runs custom code:

```json
{
  "runtime": {
    "command": "python main.py"
  }
}
```

| Field | Type | Description |
|-------|------|-------------|
| `runtime.command` | string | Shell command to execute in the sandbox |

### loop

Declares that the agent uses a managed LLM tool-use loop:

```json
{
  "loop": {
    "max_turns": 25
  }
}
```

| Field | Type | Default | Description |
|-------|------|---------|-------------|
| `loop.max_turns` | number | `25` | Maximum loop iterations (platform max: 50) |

## Optional Fields

| Field | Type | Default | Description |
|-------|------|---------|-------------|
| `default_endpoint` | string | `"analyze"` | Default endpoint for `orch run` |
| `timeout_seconds` | number | `60` | Request timeout |
| `tags` | array | `[]` | Searchable tags |
| `is_public` | boolean | `true` | Public (free) or private (Pro plan required) |
| `default_skills` | array | `[]` | Skills to inject into agent prompts (e.g., `["yourorg/writing-style"]`) |
| `skills_locked` | boolean | `false` | When true, callers cannot override default_skills via flags (immutable after publish) |
| `required_secrets` | array | `[]` | Workspace secret names to inject as env vars in the sandbox (e.g., `["EXTERNAL_API_KEY"]`). See [Building an Orchestrator](/building-agents/building-orchestrators#workspace-secrets). |

## Code Runtime Fields

Additional fields for agents with `runtime.command`:

| Field | Type | Description |
|-------|------|-------------|
| `entrypoint` | string | Entry file to execute (e.g., `sandbox_main.py`) |
| `source_url` | string | Git URL for local execution |
| `run_command` | string | Command to run locally |
| `bundle` | object | Bundle configuration (see below) |

### Bundle Configuration

Control what files are included in your code bundle:

```json
{
  "bundle": {
    "exclude": ["data/", "*.log", "large_model.bin"],
    "include": ["important.dat"]
  }
}
```

| Field | Type | Description |
|-------|------|-------------|
| `exclude` | array | Glob patterns to exclude from bundle |
| `include` | array | Glob patterns to include (overrides excludes) |

### Example

```json
{
  "name": "leak-finder",
  "type": "agent",
  "description": "Finds leaked secrets in codebases",
  "supported_providers": ["gemini"],
  "runtime": {
    "command": "python sandbox_main.py"
  },
  "entrypoint": "sandbox_main.py",
  "tags": ["security", "scanning"],
  "is_public": true
}
```

<Note>
For E2B sandbox execution (recommended), only `runtime.command` (or `entrypoint`) is needed. The `source_url` and `run_command` fields are for local execution support.
</Note>

## Direct LLM Fields

Additional fields for agents without `runtime` or `loop` (direct LLM agents):

| Field | Type | Description |
|-------|------|-------------|
| `prompt_template` | string | Prompt with `{{variable}}` placeholders |
| `input_schema` | object | JSON Schema for input validation |
| `output_schema` | object | JSON Schema for output validation |

### Example

```json
{
  "name": "summarizer",
  "type": "agent",
  "description": "Summarizes text content",
  "supported_providers": ["openai", "anthropic"],
  "prompt_template": "Summarize the following text in {{style}} style:\n\n{{text}}",
  "input_schema": {
    "type": "object",
    "properties": {
      "text": { "type": "string" },
      "style": { "type": "string", "enum": ["bullet", "paragraph", "tldr"] }
    },
    "required": ["text", "style"]
  },
  "output_schema": {
    "type": "object",
    "properties": {
      "summary": { "type": "string" }
    },
    "required": ["summary"]
  }
}
```

## Managed Loop Fields

Additional fields for agents with a `loop` config:

| Field | Type | Default | Description |
|-------|------|---------|-------------|
| `custom_tools` | array | `[]` | Command-wrapper tools available to the LLM |
| `timeout_seconds` | number | `300` | Overall execution timeout |

### Custom Tools Format

Each custom tool has:

| Field | Required | Description |
|-------|----------|-------------|
| `name` | Yes | Tool name the LLM will call |
| `description` | Yes | What the tool does (shown to LLM) |
| `command` | Yes | Shell command to execute. Use `{{param}}` for parameters. |
| `input_schema` | No | JSON Schema for parameters (required if command has `{{param}}` placeholders) |

### Example

```json
{
  "name": "cairo-test-engineer",
  "type": "agent",
  "description": "Fixes Cairo code until tests pass",
  "supported_providers": ["anthropic"],
  "loop": {
    "max_turns": 30
  },
  "timeout_seconds": 300,
  "custom_tools": [
    {
      "name": "run_tests",
      "description": "Run the Cairo test suite",
      "command": "snforge test"
    },
    {
      "name": "deploy",
      "description": "Deploy to the specified network",
      "command": "sncast deploy --network {{network}}",
      "input_schema": {
        "type": "object",
        "properties": {
          "network": { "type": "string", "description": "Target network" }
        },
        "required": ["network"]
      }
    }
  ]
}
```

<Note>
Managed loop agents also get built-in tools automatically: `bash`, `read_file`, `write_file`, `list_files`, and `submit_result`. You don't need to define these. See [Agents & Skills](/building-agents/agent-types#built-in-tools) for details.
</Note>

## Skill Composition

Agents can include skills by default using the `default_skills` field. Skills are injected into the agent's prompt at runtime.

```json
{
  "name": "code-reviewer",
  "type": "agent",
  "description": "Reviews code with best practices",
  "supported_providers": ["anthropic", "openai"],
  "default_skills": [
    "yourorg/react-best-practices",
    "yourorg/writing-style"
  ],
  "prompt_template": "Review this code:\n\n{{code}}"
}
```

When called, the agent's prompt is prepended with the content from each skill. Callers can override this behavior (unless skills are locked):

- `--skills org/skill` - Add more skills
- `--skills-only org/skill` - Replace default_skills entirely
- `--no-skills` - Ignore all skills

### Locking Skills

Add `skills_locked: true` to prevent callers from overriding your default skills:

```json
{
  "name": "secure-reviewer",
  "default_skills": ["yourorg/owasp-rules"],
  "skills_locked": true
}
```

See [Orchestration - Locking Skills](/building-agents/orchestration#locking-skills) for details.

## Manifest Section (for Orchestrator Agents)

Agents that call other agents need a `manifest` section:

```json
{
  "name": "security-review",
  "type": "agent",
  "description": "Comprehensive security review",
  "runtime": {
    "command": "python main.py"
  },
  "callable": true,
  "manifest": {
    "manifest_version": 1,
    "dependencies": [
      { "id": "joe/leak-finder", "version": "v1" },
      { "id": "joe/vuln-scanner", "version": "v1" }
    ],
    "max_hops": 2,
    "timeout_ms": 120000,
    "per_call_downstream_cap": 100
  }
}
```

### Manifest Fields

| Field | Required | Description |
|-------|----------|-------------|
| `manifest_version` | Yes | Always `1` |
| `dependencies` | Yes | Array of `{id, version}` for agents you'll call |
| `max_hops` | Yes | Max call depth (>= 1 if you have deps) |
| `timeout_ms` | Yes | Total timeout for your agent |
| `per_call_downstream_cap` | Yes | Max downstream cap per dependency call |
| `min_required_hops` | No | Minimum hops caller must allow |
| `region` | No | Deployment region |
| `visibility` | No | `public` or `private` |
| `recommended_min_caller_budget` | No | Suggested minimum budget for callers |

### Dependency Format

```json
{
  "id": "org_slug/agent_name",
  "version": "v1"
}
```

## Validation Rules

The platform validates manifests on publish:

1. **Dependencies exist** - All declared dependencies must be registered
2. **No cycles** - Dependency graph must be acyclic
3. **max_hops >= 1** - Required when dependencies are declared
4. **Version pins** - Dependencies must specify exact versions
5. **No conflicts** - `runtime` and `loop` cannot both be declared
6. **Run mode compatibility** - `always_on` requires `runtime.command` or `loop` (cannot be used with `direct_llm`)

## Complete Examples

### Always-On Code Runtime Agent

```json
{
  "name": "discord-bot",
  "type": "agent",
  "description": "Discord moderation bot",
  "supported_providers": ["any"],
  "run_mode": "always_on",
  "runtime": {
    "command": "python bot.py"
  },
  "callable": false,
  "timeout_seconds": 0,
  "tags": ["discord", "moderation"]
}
```

### On-Demand Managed Loop Agent

```json
{
  "name": "code-fixer",
  "type": "agent",
  "description": "Fixes code until tests pass",
  "supported_providers": ["anthropic"],
  "run_mode": "on_demand",
  "loop": {
    "max_turns": 30
  },
  "callable": true,
  "timeout_seconds": 300,
  "custom_tools": [
    {
      "name": "run_tests",
      "description": "Run the test suite",
      "command": "pytest"
    }
  ]
}
```

### On-Demand Direct LLM Agent

```json
{
  "name": "summarizer",
  "type": "agent",
  "description": "Summarizes documents",
  "supported_providers": ["openai", "anthropic", "gemini"],
  "run_mode": "on_demand",
  "callable": false
}
```

### Orchestrator Agent

```json
{
  "name": "security-review",
  "type": "agent",
  "description": "Comprehensive security review combining multiple scanners",
  "supported_providers": ["any"],
  "runtime": {
    "command": "python main.py"
  },
  "callable": true,
  "timeout_seconds": 180,
  "tags": ["security", "scanning", "orchestrator"],
  "manifest": {
    "manifest_version": 1,
    "dependencies": [
      { "id": "joe/leak-finder", "version": "v1" },
      { "id": "joe/vuln-scanner", "version": "v1" },
      { "id": "joe/license-checker", "version": "v1" }
    ],
    "max_hops": 2,
    "timeout_ms": 180000,
    "per_call_downstream_cap": 50,
    "min_required_hops": 2,
    "region": "us-east",
    "visibility": "public"
  }
}
```
