---
title: "Publishing"
description: "How to publish your agent or skill to orchagent"
---

Publish your agent or skill to make it available on the platform.

## Prerequisites

1. orchagent account with API key
2. CLI installed and authenticated
3. For agents: `orchagent.json` manifest in your directory
4. For skills: `SKILL.md` file in your directory

## Quick Start

```bash
# Navigate to your agent directory
cd my-agent

# Publish as public agent
orch publish --public

# Publish as private agent (default)
orch publish
```

## Visibility & Pricing

orchagent supports both public and private agents/skills:

| Visibility | Plan | Who Can Access | Marketplace |
|------------|------|----------------|-------------|
| **Public** | Free | Anyone | Listed |
| **Private** | Pro | Your org only | Hidden |

### Public (Free)
- Visible in marketplace and search
- Anyone can discover and call your agent
- Great for open-source tools and community sharing

### Private (Pro)
- Hidden from marketplace and search
- Only accessible with your org's API key
- Ideal for proprietary tools, internal workflows, or client-specific agents

<Note>
Private agents require a Pro subscription. [Contact us](mailto:hello@orchagent.io) for pricing.
</Note>

## Publishing Skills

Skills use a simpler format than agents. Create a `SKILL.md` file:

```markdown
---
name: react-best-practices
description: React optimization patterns for code review
license: MIT
metadata:
  author: yourname
  version: "1.0"
---

## Rules

- Use functional components over class components
- Memoize expensive computations with useMemo
- ...
```

Then publish:

```bash
cd my-skill
orch publish --public
```

The CLI auto-detects `SKILL.md` and publishes as a skill. See [Agent Types](/building-agents/agent-types#skills) for the full SKILL.md format.

---

## Publishing Agents

### Step 1: Initialize Your Agent

Create a new agent directory:

```bash
# Create prompt-based agent
orch init --type prompt

# Create code-based agent
orch init --type code
```

This creates the basic directory structure and `orchagent.json`.

### Step 2: Configure Your Manifest

Edit `orchagent.json` with your agent's configuration:

```json
{
  "name": "my-agent",
  "version": "v1",
  "type": "prompt",
  "description": "What my agent does",
  "supported_providers": ["openai", "anthropic"]
}
```

See [Manifest Format](/building-agents/manifest-format) for all options.

### Step 3: Test Locally

Before publishing, test your agent locally:

```bash
# For prompt-based agents
orch run . --input '{"text": "test input"}'

# For code-based agents
orch run .
```

### Step 4: Publish

```bash
# Publish as public (visible in marketplace)
orch publish --public

# Publish as private (Pro plan required, only your org can access)
orch publish --private
```

## What Happens on Publish

The platform runs several checks:

1. **Manifest validation** - Verifies `orchagent.json` is valid
2. **Schema validation** - Validates input/output schemas
3. **Dependency check** - Verifies all dependencies exist (for orchestrators)
4. **Cycle detection** - Ensures no circular dependencies

For code-based agents, the platform also:

1. Creates a ZIP bundle of your code
2. Stores the bundle securely
3. On each call, spins up an E2B sandbox
4. Runs your entrypoint with input via stdin
5. Returns stdout as the response

## Versioning

Each publish creates or updates a version:

```
https://api.orchagent.io/yourorg/my-agent/v1/analyze
https://api.orchagent.io/yourorg/my-agent/v2/analyze
```

### Version Strategy

- Increment version for breaking changes
- Old versions remain accessible for 60 days after deprecation
- Callers should pin to specific versions

### Updating an Existing Version

To update an existing version (non-breaking changes):

```bash
orch publish
```

To publish a new version:

```json
// orchagent.json
{
  "version": "v2"  // Increment version
}
```

## Code Agent Bundling

For code-based agents, the CLI automatically creates a ZIP bundle of your project.

### Auto-Detection

The CLI detects code projects by looking for:
- Python files (`.py`) with `requirements.txt`
- JavaScript files (`.js`) with `package.json`

### Entrypoint Detection

The CLI looks for entrypoints in this order:

**Python:** `main.py`, `app.py`, `agent.py`, `run.py`, `__main__.py`

**JavaScript:** `main.js`, `index.js`, `agent.js`, `main.ts`, `index.ts`, `agent.ts`

Override in your manifest:

```json
{
  "entrypoint": "sandbox_main.py"
}
```

### Bundle Exclusions

These files/directories are automatically excluded:

**Python:**
- `**/__pycache__/`, `**/*.pyc`, `**/*.pyo`, `**/*.egg-info/`
- `venv/`, `.venv/`, `env/`, `.env`
- `dist/`, `build/`, `.eggs/`
- `pyproject.toml`, `setup.py`, `setup.cfg`
- `.mypy_cache/`, `.pytest_cache/`, `.ruff_cache/`

**Node.js:**
- `node_modules/`
- `package.json`, `package-lock.json`, `yarn.lock`, `bun.lockb`
- `tsconfig.json`

**Git & IDE:**
- `.git/`, `.gitignore`, `.gitattributes`
- `.idea/`, `.vscode/`, `.DS_Store`

**Documentation:**
- `README.md`, `CHANGELOG.md`, `LICENSE`
- `docs/`

**Docker & CI:**
- `Dockerfile`, `docker-compose.yml`, `.dockerignore`
- `.github/`, `.gitlab-ci.yml`, `.circleci/`

**Tests:**
- `tests/`, `test/`, `__tests__/`
- `*_test.py`, `test_*.py`, `*.test.js`, `*.spec.ts`
- `conftest.py`, `pytest.ini`, `coverage/`

**Other:**
- `orchagent.json` (read separately)
- `*.zip`, `bundle.zip`
- `scripts/`, `Makefile`

For custom exclusions, add a `bundle` section to your manifest:

```json
{
  "name": "my-agent",
  "bundle": {
    "exclude": ["data/", "*.log"],
    "include": ["important.dat"]
  }
}
```

### Size Limits

- Maximum bundle size: **50MB**
- Keep bundles small for faster cold starts

### Dry Run

Preview your bundle without publishing:

```bash
orch publish --dry-run
```

This shows:
- Files that will be included
- Total bundle size
- Detected entrypoint

## Web UI Upload

You can also upload code agent bundles through the web dashboard as an alternative to the CLI.

### Upload via Dashboard

1. Go to [orchagent Dashboard](https://orchagent.io/dashboard)
2. Navigate to **Agents** → **My Agents**
3. Click **Upload Bundle** on your agent card
4. Drag and drop your ZIP file or click to browse

### Bundle Requirements

When uploading manually, ensure your ZIP contains:
- `orchagent.json` at the root
- Your entrypoint file (`main.py`, etc.)
- `requirements.txt` or `package.json` (if needed)

### Bundle Status

Agent cards show bundle status indicators:
- ✓ **Active** - Bundle uploaded and ready
- ⏳ **Processing** - Bundle being validated
- ✗ **Error** - Bundle validation failed (check logs)

## Service Keys

When you publish an agent that has dependencies, the platform issues a **service key**:

```json
{
  "agent": { "...": "agent fields" },
  "service_key": "sk_agent_...",
  "service_key_prefix": "sk_agent_..."
}
```

<Warning>
Store the service key securely. It's only shown once on registration. Your agent uses this key to call other agents.
</Warning>

Set it as an environment variable for your deployed agent:

```bash
export ORCHAGENT_SERVICE_KEY="sk_agent_..."
```

## Publish Options

| Flag | Description |
|------|-------------|
| `--public` | Make agent publicly visible in marketplace |
| `--private` | Keep agent private to your org (Pro plan required) |
| `--dry-run` | Validate and preview bundle without publishing |
| `--entrypoint <file>` | Override entrypoint for code agents |

## Troubleshooting

### "Manifest validation failed"

Check your `orchagent.json` for:
- Valid JSON syntax
- Required fields present
- Correct field types

### "Dependency not found"

Verify all dependencies in your manifest exist:
- Check org/agent names are correct
- Ensure dependencies are published
- Verify version strings match

### "Bundle too large"

Code agent bundles have a 50MB size limit. To reduce size:
- Check for large files that shouldn't be included
- Remove `node_modules/` or `venv/` directories
- Use `bundle.exclude` in your manifest to exclude files

### "Entrypoint not found"

The CLI auto-detects entrypoints: `main.py`, `app.py`, `agent.py`, `run.py` for Python; `main.js`, `index.js`, `agent.js` for JavaScript. If your entrypoint has a different name:

```json
{
  "entrypoint": "sandbox_main.py"
}
```

## CI/CD Integration

### GitHub Actions

```yaml
name: Publish Agent

on:
  push:
    branches: [main]

jobs:
  publish:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20'

      - name: Install CLI
        run: npm install -g orchagent

      - name: Publish
        env:
          ORCHAGENT_API_KEY: ${{ secrets.ORCHAGENT_API_KEY }}
        run: orch publish --public
```

### Environment Variables

For CI/CD, use environment variables instead of config files:

| Variable | Description |
|----------|-------------|
| `ORCHAGENT_API_KEY` | Your API key |
| `ORCHAGENT_API_URL` | API URL (defaults to production) |

## Next Steps

<CardGroup cols={2}>
  <Card title="Orchestration" icon="diagram-project" href="/building-agents/orchestration">
    Build agents that call other agents
  </Card>
  <Card title="CLI Reference" icon="terminal" href="/using-agents/cli-commands">
    All CLI commands
  </Card>
</CardGroup>
