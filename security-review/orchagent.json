{
  "name": "security-review",
  "type": "code",
  "is_public": true,
  "description": "Comprehensive security review combining secret scanning, dependency auditing, and code pattern analysis",
  "supported_providers": [
    "any"
  ],
  "tags": [
    "security",
    "orchestrator",
    "scanning",
    "secrets",
    "dependencies",
    "devops"
  ],
  "default_endpoint": "review",
  "source_url": "git+https://github.com/jp730/agents-by-orchagent.git#subdirectory=security-review",
  "manifest": {
    "manifest_version": 1,
    "dependencies": [
      {
        "id": "orchagent/leak-finder",
        "version": "v1"
      },
      {
        "id": "orchagent/dep-scanner",
        "version": "v1"
      }
    ],
    "max_hops": 2,
    "timeout_ms": 180000,
    "per_call_downstream_cap": 50,
    "downstream_spend_cap": 500
  },
  "entrypoint": "sandbox_main.py",
  "input_schema": {
    "type": "object",
    "properties": {
      "repo_url": {
        "type": "string",
        "description": "URL of the git repository to scan (use this OR path)"
      },
      "path": {
        "type": "string",
        "description": "Local directory path to scan (use this OR repo_url)"
      },
      "scan_mode": {
        "type": "string",
        "enum": ["full", "secrets-only", "deps-only", "patterns-only"],
        "default": "full",
        "description": "What to scan: full (everything), secrets-only, deps-only, or patterns-only"
      },
      "exclude": {
        "type": "array",
        "items": {"type": "string"},
        "description": "List of directory names to skip during scanning (in addition to built-in exclusions)"
      }
    }
  }
}
